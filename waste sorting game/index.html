<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡πÄ‡∏Å‡∏°‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞ - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ß‡∏±‡∏í‡∏ô‡∏≤</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&family=Kanit:wght@400;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4CAF50;
            --bg-color: #f0f8ff;
            --header-height: auto; 
        }
        
        * { box-sizing: border-box; }

        body {
            font-family: 'Sarabun', sans-serif;
            margin: 0; padding: 0;
            background-color: var(--bg-color);
            height: 100vh; height: 100dvh;
            width: 100vw;
            overflow: hidden; 
            user-select: none; -webkit-user-select: none;
        }

        /* --- Header --- */
        header {
            background: linear-gradient(135deg, #ffffff 0%, #e3f2fd 100%);
            padding: 10px 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex; align-items: center; justify-content: center; gap: 15px;
            position: fixed; top: 0; left: 0; right: 0;
            z-index: 1000; min-height: 85px;
        }
        .logo { height: 60px; width: auto; }
        .school-info { text-align: left; display: flex; flex-direction: column; justify-content: center; }
        .school-name {
            font-family: 'Kanit', sans-serif; font-size: 1rem;
            font-weight: 800; color: #1a237e; margin: 0; line-height: 1.2;
        }
        .teacher-name { font-size: 0.85rem; margin: 3px 0 0 0; color: #333; font-weight: bold; }
        .subject-name { font-size: 0.8rem; margin: 2px 0 0 0; color: #555; font-style: italic; display: block; }

        /* --- Screens --- */
        .screen {
            display: none; position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            padding-top: 100px; 
            flex-direction: column; align-items: center;
            background: var(--bg-color);
        }
        .screen.active { display: flex; }

        /* --- Login --- */
        #login-screen { z-index: 500; overflow-y: auto; justify-content: flex-start; }
        .login-box {
            background: white; padding: 25px; border-radius: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            width: 90%; max-width: 400px; text-align: center;
            margin-top: 10px; margin-bottom: 50px; border: 1px solid #e0e0e0;
        }
        .login-box h2 { 
            color: #2E7D32; font-family: 'Kanit'; margin-top: 0; 
            font-size: 1.5rem; line-height: 1.4; 
        }
        .input-group { margin-bottom: 15px; text-align: left; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 1rem; }
        .input-group input, .input-group select {
            width: 100%; padding: 10px; border: 2px solid #ccc; 
            border-radius: 10px; font-size: 1rem; background: #f9f9f9;
        }
        .btn-start {
            background: #ff9800; color: white; border: none;
            padding: 12px; width: 100%; font-size: 1.2rem; font-weight: 800;
            border-radius: 50px; cursor: pointer; font-family: 'Kanit';
            margin-top: 10px; box-shadow: 0 4px 0 #e65100; transition: transform 0.1s;
        }
        .btn-start:active { transform: translateY(4px); box-shadow: none; }

        /* --- Game --- */
        #game-screen { overflow: hidden; touch-action: none; justify-content: space-between; padding-bottom: 5px; }
        .game-status-bar {
            width: 95%; max-width: 500px; display: flex; justify-content: space-between;
            background: white; padding: 8px 20px; border-radius: 50px;
            font-family: 'Kanit'; font-size: 1.2rem; font-weight: 800;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin: 5px auto;
            border: 2px solid #eee; flex-shrink: 0; position: relative; z-index: 50;
        }
        .timer { color: #d32f2f; }
        .score { color: #388E3C; }

        #trash-container {
            flex: 1; width: 100%; position: relative;
            overflow: visible; z-index: 100;
        }
        .trash-item {
            width: 110px; height: 110px; background: white; 
            border: 4px solid #333; border-radius: 20px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.25); position: absolute;
            transform: translate(-50%, -50%); 
            z-index: 500; cursor: grab;
        }
        .trash-item:active { cursor: grabbing; transform: translate(-50%, -50%) scale(1.1); }
        .trash-item div { font-size: 3.5rem; line-height: 1; margin-bottom: 5px; pointer-events: none;}
        .trash-item span { font-family: 'Kanit'; font-weight: bold; font-size: 0.9rem; color: #333; pointer-events: none;}

        .bins-container {
            display: flex; justify-content: space-around; align-items: flex-end;
            width: 100%; padding: 5px; height: 160px; flex-shrink: 0;
            z-index: 40; background: rgba(255,255,255,0.4); border-radius: 20px 20px 0 0;
        }
        .bin {
            width: 23%; height: 100%; position: relative;
            display: flex; justify-content: center; align-items: flex-end;
            transition: transform 0.1s;
        }
        .bin img {
            width: 100%; height: 100%; object-fit: contain;
            filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1)); pointer-events: none;
        }
        .bin.hovered { transform: scale(1.15); filter: brightness(1.1); }

        /* --- Result (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡∏°‡πà) --- */
        #result-screen { z-index: 2000; background: rgba(0,0,0,0.9); padding-top: 20px; justify-content: flex-start; overflow-y: auto; }
        .result-content {
            background: white; width: 95%; max-width: 500px;
            padding: 30px; border-radius: 25px; text-align: center;
            box-shadow: 0 0 40px rgba(255,255,255,0.2);
            margin-bottom: 50px;
        }

        /* ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡∏ú‡πà‡∏≤‡∏ô/‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô */
        .status-badge {
            display: inline-block; padding: 10px 30px; border-radius: 50px;
            font-family: 'Kanit'; font-size: 1.8rem; font-weight: 800;
            margin: 10px 0; border: 4px solid;
        }
        .status-pass { color: #2E7D32; border-color: #2E7D32; background: #E8F5E9; }
        .status-fail { color: #C62828; border-color: #C62828; background: #FFEBEE; }

        /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ */
        .knowledge-box {
            background: #F1F8E9; border-radius: 15px; padding: 15px;
            margin-top: 20px; text-align: left; border: 2px solid #C5E1A5;
        }
        .knowledge-box h3 { margin: 0 0 10px 0; font-family: 'Kanit'; color: #33691E; display: flex; align-items: center; gap: 5px;}
        .knowledge-list { list-style: none; padding: 0; margin: 0; font-size: 0.95rem; }
        .knowledge-list li { margin-bottom: 8px; display: flex; align-items: flex-start; gap: 10px; }
        .color-dot { width: 15px; height: 15px; border-radius: 50%; display: inline-block; margin-top: 4px; flex-shrink: 0; border: 1px solid rgba(0,0,0,0.2);}

        /* Overlay */
        #feedback-overlay {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 2.5rem; font-weight: 800; font-family: 'Kanit';
            pointer-events: none; opacity: 0; transition: opacity 0.2s;
            z-index: 3000; padding: 20px 40px; border-radius: 50px;
            background: white; white-space: nowrap; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 5px solid;
        }
        .feedback-correct { color: #2E7D32; border-color: #2E7D32 !important; }
        .feedback-wrong { color: #c62828; border-color: #c62828 !important; }
    </style>
</head>
<body>

    <header>
        <img src="logo.png" alt="Logo" class="logo" onerror="this.style.display='none'"> 
        <div class="school-info">
            <h1 class="school-name">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ß‡∏±‡∏í‡∏ô‡∏≤</h1>
            <p class="teacher-name">‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô: ‡∏Ñ‡∏£‡∏π‡∏Ç‡∏±‡∏ô‡∏ó‡∏≠‡∏á ‡πÇ‡∏û‡∏ò‡∏¥‡πå‡πÄ‡∏ï‡∏µ‡πâ‡∏¢</p>
            <p class="subject-name">‡∏ß‡∏¥‡∏ä‡∏≤‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</p>
        </div>
    </header>

    <div id="login-screen" class="screen active">
        <div class="login-box">
            <h2>‡πÄ‡∏Å‡∏°‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞‡∏´‡∏£‡∏£‡∏©‡∏≤</h2>
            <div class="input-group">
                <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</label>
                <input type="text" id="player-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á">
            </div>
            <div class="input-group">
                <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô:</label>
                <select id="player-class">
                    <option value="‡∏õ.1">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</option>
                    <option value="‡∏õ.2">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2</option>
                    <option value="‡∏õ.3">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3</option>
                    <option value="‡∏õ.4">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4</option>
                    <option value="‡∏õ.5">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 5</option>
                    <option value="‡∏õ.6">‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 6</option>
                </select>
            </div>
            <div class="input-group">
                <label>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</label>
                <input type="number" id="player-number" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà">
            </div>
            <button class="btn-start" onclick="startGame()">‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°</button>
        </div>
    </div>

    <div id="game-screen" class="screen">
        <div class="game-status-bar">
            <div class="timer">‚è∞ <span id="time-display">60</span></div>
            <div class="score">‚≠ê <span id="score-display">0</span></div>
        </div>

        <div id="trash-container"></div>

        <div class="bins-container">
            <div class="bin" id="bin-green" data-type="green">
                <img src="bin_green.png" alt="‡∏ñ‡∏±‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß">
            </div>
            <div class="bin" id="bin-blue" data-type="blue">
                <img src="bin_blue.png" alt="‡∏ñ‡∏±‡∏á‡∏ü‡πâ‡∏≤">
            </div>
            <div class="bin" id="bin-yellow" data-type="yellow">
                <img src="bin_yellow.png" alt="‡∏ñ‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á">
            </div>
            <div class="bin" id="bin-red" data-type="red">
                <img src="bin_red.png" alt="‡∏ñ‡∏±‡∏á‡πÅ‡∏î‡∏á">
            </div>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <div class="result-content">
            <h2 style="color:#1976D2; margin-top:0; font-family:'Kanit';">‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡πâ‡∏ß!</h2>
            <p style="font-size:1.1rem;">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô: <span id="result-player" style="font-weight:bold; color:#333;"></span></p>
            
            <div id="status-badge" class="status-badge"></div>
            
            <div style="font-size: 1.5rem; font-weight:800; font-family:'Kanit'; color:#555; margin-top:10px;">
                ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: <span id="result-score" style="font-size: 2.5rem; color:#333;">0</span>
            </div>
            <p id="result-msg" style="color:#666; font-weight:bold; margin: 10px 0;"></p>

            <div class="knowledge-box">
                <h3>üí° ‡∏à‡∏≥‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡πÅ‡∏¢‡∏Å‡∏ñ‡∏π‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ</h3>
                <ul class="knowledge-list">
                    <li>
                        <span class="color-dot" style="background:#4CAF50;"></span>
                        <span><b>‡∏ñ‡∏±‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå):</b> ‡∏Ç‡∏¢‡∏∞‡πÄ‡∏ô‡πà‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡πÑ‡∏î‡πâ ‡∏¢‡πà‡∏≠‡∏¢‡∏™‡∏•‡∏≤‡∏¢‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏®‡∏©‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡πÉ‡∏ö‡πÑ‡∏°‡πâ ‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡πÑ‡∏°‡πâ</span>
                    </li>
                    <li>
                        <span class="color-dot" style="background:#2196F3;"></span>
                        <span><b>‡∏ñ‡∏±‡∏á‡∏ü‡πâ‡∏≤ (‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•):</b> ‡∏Ç‡∏¢‡∏∞‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ ‡∏ô‡∏≥‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏ß‡∏î‡∏ô‡πâ‡∏≥ ‡πÅ‡∏Å‡πâ‡∏ß ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© ‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á</span>
                    </li>
                    <li>
                        <span class="color-dot" style="background:#FFEB3B;"></span>
                        <span><b>‡∏ñ‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á (‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ):</b> ‡∏Ç‡∏¢‡∏∞‡∏¢‡πà‡∏≠‡∏¢‡∏™‡∏•‡∏≤‡∏¢‡∏¢‡∏≤‡∏Å ‡πÑ‡∏°‡πà‡∏Ñ‡∏∏‡πâ‡∏°‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• ‡πÄ‡∏ä‡πà‡∏ô ‡∏ñ‡∏∏‡∏á‡∏Ç‡∏ô‡∏° ‡πÇ‡∏ü‡∏° ‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô</span>
                    </li>
                    <li>
                        <span class="color-dot" style="background:#F44336;"></span>
                        <span><b>‡∏ñ‡∏±‡∏á‡πÅ‡∏î‡∏á (‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢):</b> ‡∏Ç‡∏¢‡∏∞‡∏°‡∏µ‡∏û‡∏¥‡∏© ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏°‡∏≤‡∏Å ‡πÄ‡∏ä‡πà‡∏ô ‡∏ñ‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏â‡∏≤‡∏¢ ‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü ‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡∏™‡πÄ‡∏õ‡∏£‡∏¢‡πå ‡∏¢‡∏≤‡∏Ü‡πà‡∏≤‡πÅ‡∏°‡∏•‡∏á</span>
                    </li>
                </ul>
            </div>

            <button class="btn-start" onclick="location.reload()" style="margin-top:20px;">üîÑ ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        </div>
    </div>

    <div id="feedback-overlay"></div>

    <audio id="bgm" loop preload="auto"><source src="bgm.mp3" type="audio/mpeg"></audio>
    <audio id="sfx-correct" preload="auto"><source src="correct.mp3" type="audio/mpeg"></audio>
    <audio id="sfx-wrong" preload="auto"><source src="wrong.mp3" type="audio/mpeg"></audio>

    <script>
        const gameDuration = 60; 
        let timer;
        let timeLeft = gameDuration;
        let score = 0;
        let currentDragItem = null;

        const trashData = [
            { name: "‡πÄ‡∏®‡∏©‡∏ú‡∏±‡∏Å", type: "green", icon: "ü•¨" },
            { name: "‡∏Å‡∏≤‡∏á‡∏õ‡∏•‡∏≤", type: "green", icon: "üêü" },
            { name: "‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡πâ‡∏ß‡∏¢", type: "green", icon: "üçå" },
            { name: "‡πÄ‡∏®‡∏©‡∏Ç‡πâ‡∏≤‡∏ß", type: "green", icon: "üçö" },
            { name: "‡∏Ç‡∏ß‡∏î‡∏ô‡πâ‡∏≥", type: "blue", icon: "üß¥" },
            { name: "‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©", type: "blue", icon: "üìÑ" },
            { name: "‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á", type: "blue", icon: "ü•´" },
            { name: "‡∏Ç‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏ß", type: "blue", icon: "üçæ" },
            { name: "‡∏ñ‡∏∏‡∏á‡∏Ç‡∏ô‡∏°", type: "yellow", icon: "üçü" },
            { name: "‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÇ‡∏ü‡∏°", type: "yellow", icon: "ü•°" },
            { name: "‡πÄ‡∏®‡∏©‡∏ú‡πâ‡∏≤", type: "yellow", icon: "üëï" },
            { name: "‡∏´‡∏•‡∏≠‡∏î", type: "yellow", icon: "ü•§" },
            { name: "‡∏ñ‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏â‡∏≤‡∏¢", type: "red", icon: "üîã" },
            { name: "‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü", type: "red", icon: "üí°" },
            { name: "‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡∏™‡∏µ", type: "red", icon: "üé®" },
            { name: "‡∏¢‡∏≤‡∏Ü‡πà‡∏≤‡πÅ‡∏°‡∏•‡∏á", type: "red", icon: "‚ò†Ô∏è" }
        ];

        function initDragSystem() {
            const container = document.getElementById('trash-container');
            container.addEventListener('mousedown', handleDragStart);
            document.addEventListener('mousemove', handleDragMove);
            document.addEventListener('mouseup', handleDragEnd);
            container.addEventListener('touchstart', handleDragStart, {passive: false});
            document.addEventListener('touchmove', handleDragMove, {passive: false});
            document.addEventListener('touchend', handleDragEnd);
            document.addEventListener('touchcancel', handleDragEnd);
        }

        initDragSystem();

        function handleDragStart(e) {
            const target = e.target.closest('.trash-item');
            if (!target) return;
            e.preventDefault();
            currentDragItem = target;
            currentDragItem.style.transition = 'none';
            currentDragItem.style.zIndex = 1000;
            moveItem(e);
        }

        function handleDragMove(e) {
            if (!currentDragItem) return;
            e.preventDefault();
            moveItem(e);
            checkHover(currentDragItem);
        }

        function handleDragEnd(e) {
            if (!currentDragItem) return;
            const item = currentDragItem;
            currentDragItem = null;
            item.style.transition = 'all 0.3s cubic-bezier(0.25, 1, 0.5, 1)';
            item.style.zIndex = 500;
            checkDrop(item);
        }

        function moveItem(e) {
            const evt = e.touches ? e.touches[0] : e;
            const container = document.getElementById('trash-container');
            const containerRect = container.getBoundingClientRect();
            const x = evt.clientX - containerRect.left;
            const y = evt.clientY - containerRect.top;
            currentDragItem.style.left = x + 'px';
            currentDragItem.style.top = y + 'px';
        }

        function startGame() {
            const name = document.getElementById('player-name').value.trim();
            const number = document.getElementById('player-number').value.trim();
            if(!name || !number) { alert("‡∏ô‡πâ‡∏≠‡∏á‡πÜ ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö!"); return; }

            document.getElementById('login-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');

            const bgm = document.getElementById('bgm');
            const sfxC = document.getElementById('sfx-correct');
            const sfxW = document.getElementById('sfx-wrong');
            bgm.volume = 0.3;
            [bgm, sfxC, sfxW].forEach(audio => {
                audio.muted = true; 
                audio.play().then(() => {
                    audio.pause(); audio.currentTime = 0; audio.muted = false;
                    if(audio === bgm) bgm.play();
                }).catch(e => {});
            });

            spawnItem();
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('time-display').innerText = timeLeft;
                if(timeLeft <= 0) endGame();
            }, 1000);
        }

        function spawnItem() {
            const container = document.getElementById('trash-container');
            container.innerHTML = ''; 
            const data = trashData[Math.floor(Math.random() * trashData.length)];
            const item = document.createElement('div');
            item.className = 'trash-item';
            item.dataset.type = data.type;
            item.innerHTML = `<div>${data.icon}</div><span>${data.name}</span>`;
            item.style.left = '50%'; item.style.top = '50%';
            container.appendChild(item);
        }

        function checkHover(item) {
            const itemRect = item.getBoundingClientRect();
            const centerX = itemRect.left + (itemRect.width / 2);

            document.querySelectorAll('.bin').forEach(bin => {
                const binRect = bin.getBoundingClientRect();
                if (centerX > binRect.left && centerX < binRect.right) {
                    bin.classList.add('hovered');
                } else {
                    bin.classList.remove('hovered');
                }
            });
        }

        function checkDrop(item) {
            const itemRect = item.getBoundingClientRect();
            const centerX = itemRect.left + (itemRect.width / 2);
            const centerY = itemRect.top + (itemRect.height / 2);
            let dropped = false;
            
            document.querySelectorAll('.bin').forEach(bin => {
                bin.classList.remove('hovered');
                const binRect = bin.getBoundingClientRect();
                const isInZone = 
                    centerX > binRect.left && 
                    centerX < binRect.right && 
                    centerY > (binRect.top - 100); 

                if (isInZone) {
                    dropped = true;
                    if (item.dataset.type === bin.dataset.type) handleResult(true);
                    else handleResult(false);
                }
            });
            
            if (!dropped) {
                setTimeout(() => {
                    item.style.left = '50%'; item.style.top = '50%';
                }, 50);
            }
        }

        function handleResult(isCorrect) {
            const text = isCorrect ? "‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö! ‚úÖ" : "‡∏ú‡∏¥‡∏î‡∏ñ‡∏±‡∏á‡∏ô‡∏∞ ‚ùå";
            const cls = isCorrect ? "feedback-correct" : "feedback-wrong";
            const sfx = document.getElementById(isCorrect ? 'sfx-correct' : 'sfx-wrong');
            try { sfx.currentTime = 0; sfx.play(); } catch(e) {}

            const fb = document.getElementById('feedback-overlay');
            fb.innerText = text; fb.className = cls; fb.style.opacity = 1;
            setTimeout(() => fb.style.opacity = 0, 800);

            if(isCorrect) {
                score += 10;
                document.getElementById('score-display').innerText = score;
                document.getElementById('trash-container').innerHTML = ''; 
                setTimeout(spawnItem, 600);
            } else {
                const item = document.querySelector('.trash-item');
                setTimeout(() => {
                    item.style.left = '50%'; item.style.top = '50%';
                }, 50);
            }
        }

        function endGame() {
            clearInterval(timer);
            document.getElementById('game-screen').classList.remove('active');
            document.getElementById('result-screen').classList.add('active');
            
            const name = document.getElementById('player-name').value;
            const cls = document.getElementById('player-class').value;
            const num = document.getElementById('player-number').value;
            document.getElementById('result-player').innerText = `${name} (${cls} ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${num})`;
            document.getElementById('result-score').innerText = score;

            // --- ‡∏ï‡∏±‡∏î‡πÄ‡∏Å‡∏£‡∏î (Pass/Fail Logic) ---
            const badge = document.getElementById('status-badge');
            const msg = document.getElementById('result-msg');

            if (score >= 80) {
                badge.innerHTML = "‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå ‚úÖ";
                badge.className = "status-badge status-pass";
                msg.innerText = "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞";
            } else {
                badge.innerHTML = "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå ‚ùå";
                badge.className = "status-badge status-fail";
                msg.innerText = "‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ 80 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ ‡∏•‡∏≠‡∏á‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö";
            }
        }
    </script>
</body>
</html>